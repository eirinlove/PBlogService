<html>

<!-- include libraries(jQuery, bootstrap) -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- include summernote css/js -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

<body>
   
    <div class ="titleView">제목
        <input type ="text" class = "titleText"> 
    </div>
    <form method="post">
        <div id="summernote" name="editordata"></div>
      </form>
       
      
        <button class = 'write'>작성</button>
    
      <script>

$(document).ready(function() {
	//여기 아래 부분
	$('#summernote').summernote({
		  height: 300,                 // 에디터 높이
		  minHeight: null,             // 최소 높이
		  maxHeight: null,             // 최대 높이
		  focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
		  lang: "ko-KR",					// 한글 설정
		  placeholder: '최대 2048자까지 쓸 수 있습니다',	//placeholder 설정
          callbacks : {   // 이미지 설정
                onImageUpload : function(files){ // 이미지 호출 함수, 드래그앤드롭, 이미지첨부 등으로 호출됨 
                    uploadSummernoteImageFile(files[0],this); // 현재 파일을 열에 등록.
                }

          }
          
	});
});


function uploadSummernoteImageFile(file, editor) {

    data = new FormData();
    data.append("img", file);
    $.ajax({

        data : data,
        type : "POST",
        url : "./upload-image",
        cache : false,
        contentType : false,
        enctype : "multipart/form-data",
        processData : false,
        success : function(response){
            $('#summernote').summernote('insertImage', response.url); // 파일의 url을 설정, 해당 url로 파일의 url을 가공할 수 있게.
        }
    });
}


$('.write').click(function(e){

var name = $('.titleText').val();
var type = $('.note-editable').html();
console.log(type);

$.ajax({

        method : 'POST',
        url : './thread/testwrite',
        data : {name : name,
                context : type}
}).done(function(rep){
    location.replace("/");
})



});



      </script>
</body>
</html>